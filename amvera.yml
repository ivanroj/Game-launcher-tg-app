meta:
  environment: python
  toolchain:
    name: pip
    version: 3.10

build:
  requirementsPath: requirements.txt

run:
  persistenceMount: /data
  containerPort: 80
  command: >
    supervisord -c /etc/supervisor/supervisord.conf

extra:
  files:
    - path: /etc/supervisor/supervisord.conf
      content: |
        [supervisord]
        nodaemon=true

        [program:gunicorn]
        command=gunicorn GameLauncher.wsgi:application --bind 0.0.0.0:80
        autostart=true
        autorestart=true
        stdout_logfile=/data/gunicorn.log
        stderr_logfile=/data/gunicorn_err.log

        [program:bot]
        command=python bot.py
        autostart=true
        autorestart=true
        stdout_logfile=/data/bot.log
        stderr_logfile=/data/bot_err.log
